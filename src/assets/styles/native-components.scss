/**
 * @file native-components.scss
 * @description 桌面原生化组件样式库
 * @note 参考 Windows 11 Fluent Design + macOS Big Sur
 */

/* ==================== 按钮组件 ==================== */

/* 主按钮（Primary） */
.btn-primary {
  height: var(--height-button-md);
  padding: 0 var(--spacing-lg);
  border: none;
  border-radius: var(--radius-md);
  background: var(--color-accent-blue);
  color: white;
  font-size: var(--text-md);
  font-weight: var(--font-medium);
  font-family: var(--font-sans);
  line-height: 1;
  cursor: pointer;
  user-select: none;
  box-shadow: var(--shadow-sm);
  transition: all var(--duration-fast) var(--ease-out-quart);

  &:hover:not(:disabled) {
    background: var(--color-accent-blue-hover);
    box-shadow: var(--shadow-md);
    transform: translateY(-1px);
  }

  &:active:not(:disabled) {
    transform: translateY(0);
    box-shadow: var(--shadow-xs);
    transition-duration: var(--duration-instant);
  }

  &:focus-visible {
    outline: 2px solid var(--color-accent-blue);
    outline-offset: 2px;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
}

/* 次要按钮（Secondary） */
.btn-secondary {
  height: var(--height-button-md);
  padding: 0 var(--spacing-lg);
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-md);
  background: var(--color-bg-secondary);
  color: var(--color-text-primary);
  font-size: var(--text-md);
  font-weight: var(--font-medium);
  cursor: pointer;
  transition: all var(--duration-fast) var(--ease-out-quart);

  &:hover:not(:disabled) {
    background: var(--color-hover-bg);
    border-color: var(--color-border-strong);
    box-shadow: var(--shadow-sm);
  }

  &:active:not(:disabled) {
    background: var(--color-active-bg);
  }
}

/* 危险按钮（Danger） */
.btn-danger {
  @extend .btn-primary;
  background: var(--color-accent-danger);

  &:hover:not(:disabled) {
    background: #c50f1f;
  }
}

/* 小按钮 */
.btn-sm {
  height: var(--height-button-sm);
  padding: 0 var(--spacing-md);
  font-size: var(--text-sm);
}

/* 图标按钮 */
.btn-icon {
  width: var(--height-button-md);
  height: var(--height-button-md);
  padding: 0;
  border: none;
  border-radius: var(--radius-md);
  background: transparent;
  color: var(--color-text-secondary);
  cursor: pointer;
  transition: all var(--duration-fast) var(--ease-out-quart);

  &:hover:not(:disabled) {
    background: var(--color-hover-bg);
    color: var(--color-text-primary);
  }

  &:active:not(:disabled) {
    background: var(--color-active-bg);
  }
}

/* ==================== 输入框组件 ==================== */

.input {
  height: var(--height-input-md);
  padding: 0 var(--spacing-md);
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-md);
  background: var(--color-bg-secondary);
  color: var(--color-text-primary);
  font-size: var(--text-base);
  font-family: var(--font-sans);
  transition: all var(--duration-fast) var(--ease-out-quart);

  &::placeholder {
    color: var(--color-text-tertiary);
  }

  &:hover:not(:disabled):not(:focus) {
    border-color: var(--color-border-strong);
  }

  &:focus {
    border-color: var(--color-border-interactive);
    box-shadow: 0 0 0 3px rgba(86, 156, 214, 0.1);
    outline: none;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
}

/* 搜索框 */
.input-search {
  @extend .input;
  padding-left: 36px;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23a1a1aa' stroke-width='2'%3E%3Ccircle cx='11' cy='11' r='8'/%3E%3Cpath d='m21 21-4.35-4.35'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: 12px center;
}

/* ==================== 卡片组件 ==================== */

.card {
  padding: var(--spacing-lg);
  border-radius: var(--radius-lg);
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border-subtle);
  box-shadow: var(--shadow-sm);
  transition: all var(--duration-normal) var(--ease-out-quart);

  &:hover {
    border-color: var(--color-border-default);
    box-shadow: var(--shadow-md);
    transform: translateY(-2px);
  }
}

/* 可点击卡片 */
.card-interactive {
  @extend .card;
  cursor: pointer;

  &:active {
    transform: translateY(0);
    box-shadow: var(--shadow-xs);
  }
}

/* ==================== 列表行组件 ==================== */

.list-row {
  padding: var(--spacing-md) var(--spacing-lg);
  border-bottom: 1px solid var(--color-border-subtle);
  background: var(--color-bg-primary);
  transition: background-color var(--duration-fast) var(--ease-out-quart);
  cursor: pointer;

  &:hover {
    background: var(--color-hover-bg);
  }

  &:active {
    background: var(--color-active-bg);
  }

  /* 选中状态 */
  &.selected {
    background: var(--color-selected-bg);
    border-left: 3px solid var(--color-accent-blue);
    padding-left: calc(var(--spacing-lg) - 3px);
  }

  /* 最后一行无边框 */
  &:last-child {
    border-bottom: none;
  }
}

/* ==================== 徽章组件 ==================== */

.badge {
  display: inline-flex;
  align-items: center;
  height: 20px;
  padding: 0 var(--spacing-sm);
  border-radius: var(--radius-sm);
  background: var(--color-bg-overlay);
  color: var(--color-text-secondary);
  font-size: var(--text-xs);
  font-weight: var(--font-medium);
  line-height: 1;
}

.badge-success {
  background: rgba(14, 124, 63, 0.15);
  color: var(--color-accent-success);
}

.badge-warning {
  background: rgba(245, 158, 11, 0.15);
  color: var(--color-accent-warning);
}

.badge-danger {
  background: rgba(220, 53, 69, 0.15);
  color: var(--color-accent-danger);
}

/* ==================== 状态指示器 ==================== */

.status-dot {
  width: 8px;
  height: 8px;
  border-radius: var(--radius-full);
  background: var(--color-text-tertiary);

  &.running {
    background: var(--color-status-running);
    box-shadow: 0 0 8px rgba(14, 124, 63, 0.6);
    animation: pulse-status 2s ease-in-out infinite;
  }

  &.stopped {
    background: var(--color-status-stopped);
  }

  &.error {
    background: var(--color-status-error);
    animation: pulse-error 1s ease-in-out infinite;
  }
}

@keyframes pulse-status {

  0%,
  100% {
    box-shadow: 0 0 8px rgba(14, 124, 63, 0.6);
  }

  50% {
    box-shadow: 0 0 16px rgba(14, 124, 63, 0.9);
  }
}

@keyframes pulse-error {

  0%,
  100% {
    box-shadow: 0 0 8px rgba(220, 53, 69, 0.6);
  }

  50% {
    box-shadow: 0 0 16px rgba(220, 53, 69, 0.9);
  }
}

/* ==================== 分隔线 ==================== */

.divider {
  height: 1px;
  background: var(--color-border-subtle);
  margin: var(--spacing-lg) 0;
}

.divider-vertical {
  width: 1px;
  height: 100%;
  background: var(--color-border-subtle);
  margin: 0 var(--spacing-md);
}

/* ==================== 工具栏 ==================== */
/* 注意：.toolbar 样式已移至各组件内部，避免全局样式冲突 */

/* ==================== 面板 ==================== */

.panel {
  background: var(--color-bg-secondary);
  border: 1px solid var(--color-border-subtle);
  border-radius: var(--radius-lg);
  overflow: hidden;
}

.panel-header {
  padding: var(--spacing-md) var(--spacing-lg);
  background: var(--color-bg-elevated);
  border-bottom: 1px solid var(--color-border-subtle);
  font-weight: var(--font-semibold);
  font-size: var(--text-md);
}

.panel-body {
  padding: var(--spacing-lg);
}

/* ==================== 通知横幅 ==================== */

.notification-banner {
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
  padding: var(--spacing-md) var(--spacing-lg);
  background: rgba(0, 120, 212, 0.08);
  border-left: 3px solid var(--color-accent-blue);
  border-radius: var(--radius-md);

  &.warning {
    background: rgba(245, 158, 11, 0.08);
    border-left-color: var(--color-accent-warning);
  }

  &.success {
    background: rgba(14, 124, 63, 0.08);
    border-left-color: var(--color-accent-success);
  }

  &.danger {
    background: rgba(220, 53, 69, 0.08);
    border-left-color: var(--color-accent-danger);
  }
}

/* ==================== 加载状态 ==================== */

.skeleton {
  background: linear-gradient(90deg,
      var(--color-bg-secondary) 0%,
      var(--color-bg-overlay) 50%,
      var(--color-bg-secondary) 100%);
  background-size: 200% 100%;
  animation: skeleton-loading 1.5s ease-in-out infinite;
  border-radius: var(--radius-md);
}

@keyframes skeleton-loading {
  0% {
    background-position: 200% 0;
  }

  100% {
    background-position: -200% 0;
  }
}

/* ==================== 响应式断点 ==================== */

@media (max-width: 768px) {
  .mobile-hidden {
    display: none;
  }
}

@media (min-width: 769px) {
  .desktop-hidden {
    display: none;
  }
}

/* ==================== 全局聚焦环样式 ==================== */

/**
 * 为所有可交互元素添加一致的 :focus-visible 聚焦环
 * 这提供了键盘导航的视觉反馈，同时不影响鼠标用户
 */

// 通用聚焦环 mixin
@mixin focus-ring($color: var(--color-accent-blue)) {
  &:focus-visible {
    outline: 2px solid $color;
    outline-offset: 2px;
  }
}

// 按钮聚焦环
button,
[role="button"],
.el-button {
  @include focus-ring;
}

// 链接聚焦环
a {
  &:focus-visible {
    outline: 2px solid var(--color-accent-blue);
    outline-offset: 2px;
    border-radius: var(--radius-sm);
  }
}

// 输入框聚焦环（不使用 outline，使用 box-shadow）
input:not([type="checkbox"]):not([type="radio"]),
textarea,
select {
  &:focus-visible {
    outline: none;
    border-color: var(--color-border-interactive);
    box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.15);
  }
}

// 复选框和单选框聚焦环
input[type="checkbox"],
input[type="radio"] {
  &:focus-visible {
    outline: 2px solid var(--color-accent-blue);
    outline-offset: 2px;
  }
}

// 列表项聚焦
.list-row,
.menu-item,
[role="listitem"],
[role="option"],
[role="menuitem"] {
  &:focus-visible {
    outline: none;
    background-color: var(--color-hover-bg);
    box-shadow: inset 0 0 0 2px var(--color-accent-blue);
  }
}

/* ==================== 毛玻璃效果 ==================== */

.glass {
  background: rgba(255, 255, 255, 0.7);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);

  [data-theme="dark"] &,
  .theme-dark & {
    background: rgba(30, 30, 30, 0.75);
  }
}

.glass-subtle {
  background: rgba(255, 255, 255, 0.5);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);

  [data-theme="dark"] &,
  .theme-dark & {
    background: rgba(30, 30, 30, 0.5);
  }
}

.glass-strong {
  background: rgba(255, 255, 255, 0.85);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);

  [data-theme="dark"] &,
  .theme-dark & {
    background: rgba(30, 30, 30, 0.9);
  }
}

/* ==================== 纯色样式替代渐变 ==================== */

// 可选的纯色 Logo 背景（如需要替代渐变）
.logo-solid {
  background-color: var(--color-accent-blue);

  &.success {
    background-color: var(--color-accent-success);
  }

  &.warning {
    background-color: var(--color-accent-warning);
  }

  &.danger {
    background-color: var(--color-accent-danger);
  }
}

// 纯色头像
.avatar-solid {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-radius: var(--radius-full);
  background-color: var(--color-accent-blue);
  color: white;
  font-weight: var(--font-semibold);

  &.purple {
    background-color: #7c3aed;
  }

  &.pink {
    background-color: #db2777;
  }

  &.green {
    background-color: var(--color-accent-success);
  }

  &.orange {
    background-color: #ea580c;
  }
}

/* ==================== 无障碍辅助 ==================== */

// 屏幕阅读器专用（视觉隐藏但可被辅助技术读取）
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

// 跳转链接（键盘导航用户可见）
.skip-link {
  position: absolute;
  top: -100%;
  left: 50%;
  transform: translateX(-50%);
  padding: var(--spacing-sm) var(--spacing-lg);
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-md);
  color: var(--color-text-primary);
  font-weight: var(--font-medium);
  z-index: var(--z-modal);

  &:focus {
    top: var(--spacing-md);
  }
}